# Overview

These scripts are used to build the training sets for the GCN.
Data is taken from a folder with annotated full RNA graphs.
Binding sites are identified by `binding_sites_analyse.py` and `binding_sites_filter.py` which uses Chimera to generate `lig_dict.p` which contains ligand residues for each PDB. 
The script `build_dataset.py` uses ligand residues `lig_dict.p` to build a graph for each ligand.
Then, `annotator.py` reads `fp_dict.p` to label each binding site graph with a fingerprint.

# `build_dataset.py`

Accepts `lig_dict.p` (generated by `binding_sites.py` ) which is a dictionary with pdb codes as keys and a list of ligand residues as values.
Builds FR3D graph for each binding site.
It's quite slow since it has to load large graphs so should only be run once.

# `annotate.py`

Once the binding site graphs are built, we annotate them (extract neighbourhood rings, associate with ligand fingerprint)
Different graph representations (edge shuffles, only watson-crick, etc) can be generated using the `ablate` option.
Dumps graph and annotations to the `annotated` folder which are sent directly to GCN.

# `graph_process.py`

Various graph handling tools (ablations, sampling context, etc.).

# `pybel_fp.py`

Generates fingerprints from SMILES.
